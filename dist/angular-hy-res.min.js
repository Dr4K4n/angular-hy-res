/**
 * angular-hy-res
 * @version v0.0.1 - 2014-08-28
 * @link https://github.com/petejohanson/angular-hy-res
 * @author Pete Johanson <latexer@gmail.com>
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
"use strict";angular.module("angular-hy-res",[]).factory("URITemplate",["$window",function(a){return a.URITemplate}]).provider("hrResource",function(){this.extensions=[],this.$get=["$http","$q","URITemplate","$injector",function(a,b,c,d){var e=[];angular.forEach(this.extensions,function(a){e.push(d.get(a))});var f=function(){this.$resolved=!1,this.$error=null,this.$$links={},this.$$embedded={},this.$$resolve=function(a,b){angular.extend(this,a);angular.forEach(e,function(c){c.applies(a,b)&&(angular.extend(this.$$links,c.linkParser(a,b)),angular.forEach(c.embeddedParser(a,b),function(a,c){this.$$embedded[c]=f.embedded(a,b)},this))},this),this.$resolved=!0},this.$link=function(a){return this.$$links.hasOwnProperty(a)?this.$$links[a]:null},this.$embedded=function(a){return this.$$embedded.hasOwnProperty(a)?this.$$embedded[a]:null},this.$followLink=function(a,b){return null===a?null:f.get(a,b)},this.$follow=function(a,b){return this.$followLink(this.$promise.then(function(b){return b.$link(a)}),b)}};f.embedded=function(a,c){var d=new f;d.$$resolve(a,c);var e=b.defer();return d.$promise=e.promise,e.resolve(d),d},f.get=function(d,e){var g=new f;return g.$promise=b.when(d).then(function(b){var d=b.href;b.templated&&(d=new c(d).expand(e.data));var f=angular.extend(e||{},{url:d});return a(f)}).then(function(a){return g.$$resolve(a.data,a.headers),g},function(){}),g};var g=function(a,b){return{get:function(){return f.get({href:a},b)}}};return g}]});