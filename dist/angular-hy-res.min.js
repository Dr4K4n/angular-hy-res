/**
 * angular-hy-res - Hypermedia client for AngularJS inspired by $resource
 * @version v0.0.5 - 2014-09-18
 * @link https://github.com/petejohanson/angular-hy-res
 * @author Pete Johanson <peter@peterjohanson.com>
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
"use strict";angular.module("angular-hy-res",[]).factory("URITemplate",["$window",function(e){return e.URITemplate}]).provider("hrResource",function(){this.extensions=[],this.$get=["$http","$q","URITemplate","$injector",function(e,n,r,t){var i=[];angular.forEach(this.extensions,function(e){i.push(t.get(e))});var s=function(){this.$resolved=!1,this.$error=null,this.$$links={},this.$$embedded={},this.$$resolve=function(e,r){angular.extend(this,e);angular.forEach(i,function(t){t.applies(e,r)&&(angular.extend(this.$$links,t.linkParser(e,r)),angular.forEach(t.embeddedParser(e,r),function(e,t){if(angular.isArray(e)){var i=e.map(function(e){return s.embedded(e,r)});i.$promise=n.when(i),i.$resolved=!0,this.$$embedded[t]=i}else this.$$embedded[t]=s.embedded(e,r)},this))},this),this.$resolved=!0},this.$link=function(e){return this.$$links.hasOwnProperty(e)?this.$$links[e]:null},this.$embedded=function(e){return this.$$embedded.hasOwnProperty(e)?this.$$embedded[e]:null},this.$followLink=function(e,r){if(null===e)return null;if(angular.isArray(e)){var t=e.map(function(e){return s.get(e,r)});return t.$promise=n.all(t.map(function(e){return e.$promise})),t.$resolved=!1,t.$promise.then(function(){t.$resolved=!0}),t}return s.get(e,r)},this.$follow=function(e,n){var r=this.$embedded(e);return null!==r?r:this.$resolved?this.$followLink(this.$link(e),n):this.$followLink(this.$promise.then(function(n){return n.$link(e)}),n)}};s.embedded=function(e,r){var t=new s;t.$$resolve(e,r);var i=n.defer();return t.$promise=i.promise,i.resolve(t),t},s.get=function(t,i){var o=new s;return o.$promise=n.when(t).then(function(n){var t=n.href;n.templated&&(t=new r(t).expand(i.data));var s=angular.extend(i||{},{url:t});return e(s)}).then(function(e){return o.$$resolve(e.data,e.headers),o},function(){}),o};var o=function(e,n){return{get:function(){return s.get({href:e},n)}}};return o}]});